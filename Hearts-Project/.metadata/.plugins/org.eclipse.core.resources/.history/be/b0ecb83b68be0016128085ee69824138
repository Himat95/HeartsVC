import java.util.ArrayList;

public class BasicGame {

	public static void main(String[] args) {
		
		Deck deck = new Deck();  	//Create a deck of 52 cards
		Table table = new Table(); 	//Create a table for the players to play on
		ArrayList<Player> players = new ArrayList<>(); 
		//An arraylist of players so I can use lambda expressions rather than loops
		//and we are able to use collection's methods. Lowering coding needed excessively.
		
		//Fill the players arraylist with 4 players, each with different IDs
		for(int i = 0; i < 4; i++) {
			players.add(new AIPlayer(i)); 
		}
		
		System.out.println("The Current Players and their scores: \n");
		players.forEach(x -> System.out.println(x.toString())); 
		
		
		deck.shuffle(); //Shuffle the deck 
		
		players.forEach(x -> x.getPlayerHand().addCards(deck.dealCards()));
		//Give each player 13 cards from the deck
		
		System.out.println("\n"); 
		System.out.println("The starting cards for each player, 13 in total: \n");
		players.forEach(x -> System.out.println(x.getPlayerHand().getCards()));
		// Print out the current cards each players have in their hand
		
		players.forEach(x -> x.getPlayerHand().sortHand());
		//Organise every player's hand so its in order by suit and then value
		
		
		// --------------------------------Game Play--------------------------------------
		
		Trick trick = table.newTrick(); //initialise a trick (takes a card each from players) 
		
		while(table.getTrickNo() != 13) { //We run 13 tricks (which uses up 52 cards) 
			
		for (int i = 0; i < 4; i++) { //Each player throws a card into the trick
			trick.addtoTrick(players.get(i).getPlayerHand().throwCard());
		}
		
		
		System.out.println("\n \t" + trick.toString() + "\n"); //Show what cards are in the trick
		
		trick.calculateScore(); //Calculates the score
		
		players.forEach(x -> {
			if (x.getPlayerHand().lastThrownCard() == trick.calculateWinner()) {
				trick.setWinner(x);
			}
		}); 
		
		
		for (int i = 0; i < 4; i++) {
			if (players.get(i).getPlayerId() == trick.getWinner()) {
				players.get(i).setScore(trick.getScoreCount());
			}
		}
		
		players.forEach(x -> {
			if (x.getPlayerId() == trick.getWinner()) {
				x.addToTrickCardsWon(trick.getTrickCards());
			}
		}); 
		
		players.forEach(x -> System.out.println(x.getPlayerHand().getCards() + "\n"));
		players.forEach(x -> System.out.println(x.toString() + "\n" ));
		players.forEach(x -> System.out.println(x.getTrickCardsWon() + "\n" ));
		
		trick.clearTrick();
		table.incTrickNo(); 
		}

	}
	

}
